LIST P=16F877
#INCLUDE <P16F877.INC>
	COUNT EQU	0X20
	CORR	EQU	0X21
	CON1	EQU 0X22
	CON2	EQU 0X23
	CON3	EQU 0X24
	CON4	EQU	0X25


	ORG 00H
	GOTO MAIN
	ORG 04H
	GOTO INT
	ORG 06H

TABLA
	ADDWF	PCL
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0XFF
	RETLW	0X04
	RETLW	0XFF
	RETLW	0XFF




MAIN
	CLRF TMR1H
	CLRF TMR1L
	BSF STATUS,5
	CLRF	TRISB
	BCF		STATUS,5
	MOVLW	b'00111001
;ENABLE TIMER1, INTERNAL CLOCK, IGNORED, OSCILLATOR SHUT OFF, 1:8 PRESCALER
	MOVWF	T1CON
	MOVLW 0X00
	MOVWF CON1
	MOVLW 0XFF
	MOVWF COUNT


	BCF		PIR1,0; LIMPIA BANDERA DE INTERRUPCIÓN DEL TIMER1
		BSF		STATUS,5; CAMBIO DE BANCO
		BSF		PIE1,0; HABILITA LA INTERRUPCIÓN DEL TIMER1, PRIMER NIVEL 
		BCF		STATUS,5;
		BSF		INTCON,6;  HABILITAR LAS INTERRUPCIONES PERIFÉRFICAS, SEGUNDO NIVEL
		BSF		INTCON,7; 	HABILITACIÓN GLOBAL DE INTERRUPCIONES, TERCER NIVEL
	MOVLW	0XFF
	MOVWF	CORR
	MOVWF	PORTB
	BCF	STATUS,0
RETARDO NOP
	GOTO RETARDO	
INT
	MOVLW 0X00
	SUBWF	COUNT,0
	BTFSC	STATUS,Z
GOTO TUBO
GOTO RET	
TUBO
	INCF CON1
	MOVF	CON1,0
	CALL TABLA
	MOVWF	COUNT
RET
	DECFSZ COUNT
	GOTO UNO
	MOVLW .26
	SUBWF	CON1,0
	BTFSC	STATUS,Z
GOTO	FINAL
UNO
	BCF	PIR1,0
	RETFIE	
FINAL
	COMF	CORR
	MOVF	CORR,0
	MOVWF	PORTB
GOTO UNO
			
END

